<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <link rel="stylesheet" href="css/janken.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Overlock:wght@900&family=Roboto:wght@500&family=Zen+Kaku+Gothic+New&family=Zen+Maru+Gothic:wght@300;400;500;700;900&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Gamja+Flower&family=Overlock:wght@900&family=Roboto:wght@500&family=Zen+Kaku+Gothic+New&family=Zen+Maru+Gothic:wght@300;400;500;700;900&display=swap" rel="stylesheet">
<title>ã˜ã‚ƒã‚“ã‘ã‚“</title>
</head>

<body>

    <header>
        <h1>ã„ã¡ã”ãƒ‘ãƒ³ã‚±ãƒ¼ã‚­å…¨éƒ¨é£Ÿã¹ã¦</h1>
    </header>

    <main>
        <!-- ãƒ‘ãƒ³ã‚±ãƒ¼ã‚­ã®ç”»åƒã¨ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ã®æ‰‹ -->
        <div class="game-area">
            <div id="computer-hand" class="computer-hand">ğŸ¤–</div>
            <img src="./img/pancake03.png" alt="Pancake" class="pancake">
        </div>
        
        <!-- å‹æ•—ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ -->
        <div id="message" class="message"></div> <!-- åˆæœŸçŠ¶æ…‹ã§ã¯ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ç©ºã«ã€‚ -->
    

        <!-- ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®é¸æŠï¼ˆã‚°ãƒ¼ã€ãƒãƒ§ã‚­ã€ãƒ‘ãƒ¼ï¼‰ -->
        <div class="choices">  
            <div id="gu_btn" class="hand">âœŠ</div>
            <div id="cho_btn" class="hand">âœŒï¸</div>
            <div id="par_btn" class="hand">âœ‹</div>
        </div>

        <!-- Playãƒœã‚¿ãƒ³ -->
        <button class="play-button">PLAY</button>

        <!-- retry ãƒœã‚¿ãƒ³ -->
        <button id="retry-button" class="retry-button" style="display: none;">ãƒªãƒˆãƒ©ã‚¤</button>

         <!-- end message  -->
        <div id="endgame-message" class="endgame-message"></div>

    </main>

    
    <footer></footer>
  
    <script>
const pancakeStates = {
  // ã‚²ãƒ¼ãƒ ã®çŠ¶æ…‹ãŒ æ•°å­— ã®ã¨ãã«è¡¨ç¤ºã™ã‚‹ç”»åƒã®ãƒ‘ã‚¹
  0: './img/pancake00.png',
  1: './img/pancake01.png',
  2: './img/pancake02.png',
  3: './img/pancake03.png',
  4: './img/pancake04.png',
  5: './img/pancake05.png',
  6: './img/pancake06.png',
  7: './img/pancake07.png'
};

let currentState = 3; // Starting state

 // currentStateãŒ0ã¾ãŸã¯7ã«ãªã£ãŸã¨ãã®å‡¦ç†
function updatePancakeState(won) {
  if (won) {
    currentState = Math.max(0, currentState - 1); // 0ãŒæœ€å°å€¤
  } else {
    currentState = Math.min(7, currentState + 1); // 7ãŒæœ€å¤§å€¤
  }

  // Update the image source cssèª­ã¿è¾¼ã¿ãƒ»ç”»åƒåˆ‡ã‚Šæ›¿ãˆ
  document.querySelector('.pancake').src = pancakeStates[currentState];


  // ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼ã¾ãŸã¯å‹åˆ©ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤º
     if (currentState === 0 || currentState === 7) {

      // æ¡ä»¶ ? çœŸã®å ´åˆã®å€¤ : å½ã®å ´åˆã®å€¤;
        const message = currentState === 0 ? "You successfully ate them allğŸ¤¤ğŸ´" : "NO MORE PANCAKES FOR MEğŸš«ğŸ¤®";
        
        $("#endgame-message").text(message).css("visibility", "visible"); //éè¡¨ç¤ºã¨è¡¨ç¤ºã‚’åˆ‡ã‚Šæ›¿ãˆ
        $("#retry-button").show(); // ãƒªãƒˆãƒ©ã‚¤ãƒœã‚¿ãƒ³ã‚’è¡¨ç¤º. display: none;ãŒè¨­å®šã•ã‚Œã¦ã„ãŸè¦ç´ ã‚’ã€ç”»é¢ä¸Šã«è¡¨ç¤º
        $(".play-button").hide(); // PLAYãƒœã‚¿ãƒ³ã‚’éè¡¨ç¤ºã« 
    }
}

$(document).ready(function() {
  // ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒæ‰‹ã‚’é¸æŠ
  $(".hand").on("click", function() {
    $(".hand").removeClass("selected"); //ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒæ–°ãŸã«æ‰‹ã‚’é¸æŠã™ã‚‹ãŸã³ã«ã€selected ã‚¯ãƒ©ã‚¹ã‚’å‰Šé™¤ã€‚ä»¥å‰ã«é¸æŠã•ã‚Œã¦ã„ãŸæ‰‹ã®é¸æŠçŠ¶æ…‹ã‚’ãƒªã‚»ãƒƒãƒˆ
    $(this).addClass("selected");  //ã‚¯ãƒªãƒƒã‚¯ã•ã‚ŒãŸç‰¹å®šã®ã€Œæ‰‹ã€ã« selected ã‚¯ãƒ©ã‚¹ã‚’è¿½åŠ 
  });

  // PLAYãƒœã‚¿ãƒ³ã‚’æŠ¼ã™ã¨ã‚²ãƒ¼ãƒ ã‚¹ã‚¿ãƒ¼ãƒˆ
  $(".play-button").on("click", function() {
    const userChoice = $(".hand.selected").attr("id"); //é¸æŠã•ã‚ŒãŸè¦ç´ ã® id å±æ€§ã®å€¤ã‚’å–å¾—. å€¤ã‚’ userChoice
    if (!userChoice) {     //userChoice ãŒå½ã£ã½ã„å€¤ã®å ´åˆ
      alert("æ‰‹ã‚’é¸ã‚“ã§ï¼");
      return;
    }

    // ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ã®æ‰‹ã‚’ãƒ©ãƒ³ãƒ€ãƒ ã«é¸æŠã—ã¦è¡¨ç¤º
    const hands = { 'gu_btn': 'âœŠ', 'cho_btn': 'âœŒï¸', 'par_btn': 'âœ‹' };
    const choices = Object.keys(hands); //handsã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ã‚­ãƒ¼ï¼ˆIDï¼‰ã‚’å–å¾—ã—é…åˆ—ã«æ ¼ç´
    //choices[0]ï¼ˆ'gu_btn'ï¼‰ã€choices[1]ï¼ˆ'cho_btn'ï¼‰ã€choices[2]ï¼ˆ'par_btn'ï¼‰
    const computerChoice = choices[Math.floor(Math.random() * choices.length)]; //Object.keys(hands)ã«ã‚ˆã£ã¦ç”Ÿæˆã•ã‚Œã‚‹choicesé…åˆ—ã«3ã¤ã®è¦ç´ ãŒå«ã¾ã‚Œã‚‹ãŸã‚ã€‚
    $("#computer-hand").text(hands[computerChoice]).css("visibility", "visible");

    // å‹æ•—åˆ¤å®š
    determineWinner(userChoice, computerChoice);
  });

  function determineWinner(user, computer) {
    let userWon = false;

    // "ã‚ã„ã“"ã®å ´åˆã€currentStateã¯å¤‰æ›´ã—ãªã„
    if (user === computer) {
      $("#message").text("ãŸã¹ãŸã„...").css("visibility", "visible");
       // ã“ã“ã§ã¯updatePancakeStateã¯å‘¼ã³å‡ºã•ãªã„
      return;
    }

    const winConditions = {
        'gu_btn': 'cho_btn',
        'cho_btn': 'par_btn',
        'par_btn': 'gu_btn'
    };

    if (winConditions[user] === computer) { //ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ‰‹ãŒå‹ã¤æ‰‹ã®å€¤ãŒ computer ã¨ä¸€è‡´ã™ã‚‹ãªã‚‰ã°
        $("#message").text("Yay!");
        userWon = true;
    } else {
        $("#message").text("Oh no!");
        userWon = false;
    }

    // å‹æ•—ã«å¿œã˜ã¦ãƒ‘ãƒ³ã‚±ãƒ¼ã‚­ã®çŠ¶æ…‹ã‚’æ›´æ–°
    updatePancakeState(userWon);
    $("#message").css("visibility", "visible");
  }

  $("#retry-button").on("click", function() {
        // ã‚²ãƒ¼ãƒ ã®çŠ¶æ…‹ã‚’ãƒªã‚»ãƒƒãƒˆ
        currentState = 3;
        $("#computer-hand").css("visibility", "hidden");
        $("#endgame-message").css("visibility", "hidden");
        $(".play-button").show(); // PLAYãƒœã‚¿ãƒ³ã‚’å†è¡¨ç¤º
        $(this).hide(); // ãƒªãƒˆãƒ©ã‚¤ãƒœã‚¿ãƒ³ã‚’éš ã™
        $("#message").css("visibility", "hidden");
        $(".pancake").attr("src", pancakeStates[currentState]); // åˆæœŸç”»åƒã«æˆ»ã™
    });

});
    </script>
</body>


</html>
